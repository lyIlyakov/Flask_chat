<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Список чатов</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
<header>
    <h1>Список чатов</h1>
</header>
<main>
    <div class="chat-list">
        {% if conversations %}
            {% for conversation, last_message in conversations %}
                <a href="{{ url_for('chat', conversation_id=conversation.id) }}" class="chat-item">
                    <div>
                        {% if conversation.type == 'direct' %}
                            {% set other = conversation.user1 if conversation.user1 != current_user else conversation.user2 %}
                            <h3>@{{ other.username }}</h3>
                        {% else %}
                            <h3>{{ conversation.name }}</h3>
                        {% endif %}
                        {% if last_message %}
                            <p>{{ last_message.text[:50] + '...' if last_message.text|length > 50 else last_message.text }}</p>
                        {% else %}
                            <p>Нет сообщений</p>
                        {% endif %}
                    </div>
                </a>
            {% endfor %}
        {% else %}
            <p>У вас пока нет чатов. <a href="{{ url_for('start_chat') }}">Начните новый чат</a> или <a
                href="{{ url_for('create_group') }}">создайте группу</a>.</p>
        {% endif %}
    </div>
    <div class="sidebar">
        <a href="{{ url_for('settings') }}">Настройки</a>
        <a href="{{ url_for('create_group') }}">Создать группу</a>
        <a href="{{ url_for('start_chat') }}">Начать чат</a>
        <a href="{{ url_for('logout') }}">Выйти</a>
    </div>
</main>
<footer>
    <p>chater</p>
</footer>
<a href="{{ url_for('start_chat') }}" class="fab">+</a>
</body>
</html>